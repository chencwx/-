# IoT Internet of Threats A Survey of PracticalSecurity Vulnerabilities in Real IoT Devices
- Title
- Author
- Abstract
- 正文
  - I.  INTRODUCTION
  - II. SECURITYCHALLENGES IN THEIOT DOMAIN
  - III. MAIN SECURITY MECHANISMS FOR IOT SERVICES
  - IV. SECURITY OF POPULAR IOT COMMUNICATION TECHNOLOGIES
  - V. EXAMPLES OF IMPLEMENTATIONS IN COMMERCIAL DEVICES
  - VI. FINAL REMARKS
  -  VII. OPEN CHALLENGES
- References 

## Title

IoT Internet of Threats A Survey of PracticalSecurity Vulnerabilities in Real IoT Devices

物联网:互联网的威胁?真实物联网设备的实际安全漏洞调查

## Author

- Francesca Meneghello,Student Member , IEEE
- Matteo Calore, Daniel Zucchetto,Member , IEEE
- Michele Polese,Student Member , IEEE
- Andrea Zanella,Senior Member , IEEE

## Abstract

- 随着物联网的快速发展，网络安全对于避免诸如合理信息泄露、拒绝服务(DoS)攻击、未经授权的网络访问等威胁变得至关重要。许多低端物联网商业产品通常不支持强大的安全机制，因此可能成为许多安全攻击的目标。

- 本文目的：提供物联网领域的安全风险的广泛概述，并讨论一些可能的应对措施。

- 对物联网领域的安全进行一般性介绍，讨论了目前最流行的物联网通信协议所采用的具体安全机制。
- 报告并分析了文献中报道的针对真实物联网设备的一些攻击，以指出目前商用物联网解决方案的安全弱点，并指出将安全作为物联网系统设计的一个组成部分的重要性。
- 在本文的结尾，我们对所考虑的物联网技术就一组合格的**安全属性**进行了合理的比较
  - 完整性、匿名性、保密性、私密性、访问控制、身份验证、授权、弹性和自组织。

## I. INTRODUCTION

### 当今物联网面临的安全问题

- 物联网设备的数量和种类在过去几年里迅速增长，如智能家电、智能家居、智能手表、智能电视等，这类设备最初设计用于在隔离系统中工作，因此安全威胁要有限得多。但是随着物联网的发展许多这样的智能服务要求用户在变更时有意地透露一些个人(有时是私人)信息，以获得更高级和更个性化的服务。

- 不幸的是，许多物联网商业产品提供的安全机制不充分、不完整或设计不良。事实上，许多物联网设备制造商来自低成本传感器和执行器市场(例如，家庭自动化、灯光控制、视频监控等)。

- 为了使商用物联网设备更能抵御网络攻击，应该从新产品的设计阶段就开始考虑安全问题。物联网设备的广泛异构性阻碍了物联网的成熟设计安全方法的发展。由于许多物联网设备在能源、通信、计算和存储能力方面的严重限制，这一挑战变得更加复杂。这些限制确实阻止了采用更传统的连接互联网的设备中使用的标准安全机制的可能性，并要求新的解决方案，然而，物联网设备尚未标准化。

### 本文结构

提供当前物联网网络安全场景的最新愿景，有助于提高对物联网设备可能代表的威胁的认识。本文将讨论此类威胁的起源和可能的应对措施，这里我们从一个更实际的角度来解决这个问题。

![](./img/QQ截图20211123140150.png)

- 第二节回顾了物联网系统的主要功能和相关的安全挑战

- 第三节描述了本文考虑的主要安全算法和协议。此外，本文还提供一些与商业物联网设备中常用的芯片组中安全协议实现相关的细节。
- 第四节专门讨论物联网的通信协议。简要回顾了每种技术的主要特征，特别关注其自身的安全机制。然后，提供攻击表面的关键分析，即与该协议相关的可能漏洞。
- 第五节报告了广泛的物联网解决方案的实际实施细节，特别是讨论了一些硬件方面，如微控制器和连接模块，它们在确定此类设备的安全级别中起着重要作用。
- 第六节对本文所考虑的设备进行了定性的比较
- 第七节中总结了本文的一些开放的研究方向。

## II. SECURITY CHALLENGES IN THE IOT DOMAIN

本章主要讨论物联网系统的主要功能和相关的安全挑战

针对物联网设备的攻击通常很简单，很容易实施。它们可能是为了破坏用户隐私和泄露个人智能的信息。收集到的数据范围确实很广，从简单的室温和湿度测量，到心率信号或用户的位置和生活习惯等更敏感的信息。还有一种常见的攻击策略是危及物联网网络中的一个设备，并将其作为攻击的切入口，对另一个网络节点实施欺诈行为。

### A.安全需求分类

根据不同的操作级别，即在信息、访问和功能级别，对物联网系统的安全需求进行分类。

- 信息层面：在这个层面上，安全性应该保证以下需求：
  - 完整性:接收的数据在传输过程中不应被改变。
  - 匿名性:数据源的身份应该对第三方保密。
  - 保密性:第三方无法读取数据。为了交换受保护的信息，物联网设备之间应该建立信任关系。复制的消息还必须是可识别的。
  - 隐私性:在数据交换过程中不应泄露客户的私人信息。窃听者一定很难推断出可识别的信息。
- 访问层面:它指定一些安全机制来控制对网络的访问。它提供了以下功能：
  - 访问控制:保证只有合法的用户才能访问设备和网络进行管理任务(如远程重编程或控制物联网设备和网络。
  - 认证:检查设备是否有访问网络的权限，以及网络是否有连接设备的权限。
  - 授权:保证只有授权的设备和用户才能访问网络服务或资源。

- 功能级别:这个级别根据以下标准定义安全需求：
  - 弹性:保证设备安全的网络容量，即使发生攻击和故障。
  - 自我管理:它表示物联网系统的自我调整能力，以便在某些部件因偶然故障或恶意攻击而出现故障的情况下保持运行。

### B.安全攻击分类

下面将介绍针对通信层的攻击的可能分类:

- 边缘层:这一级别的主要威胁之一由边信道攻击为代表。这些攻击的目的是在节点执行加密过程的同时，通过分析功耗、电磁发射、通信时间等副信号来泄露信息。
- 访问/中间件层:在这一层，主要的攻击是窃听(也称为嗅探)，注入欺诈性数据包和未经授权的对话。
- 应用层:应用层攻击与之前的攻击有很大的不同。应用层攻击直接针对设备上运行的软件，而不是通信技术。这类攻击可能解决了机器学习算法的完整性问题，攻击者操纵学习算法的训练过程来诱导错误行为。在登录和身份验证阶段也可能存在攻击。
- 忽略功能:该类包括所有忽略物联网设备的特定功能的攻击，只利用其连接到局域网(LAN)或Internet的能力。例如，物联网设备可以用来创建一个网络(一个完全由攻击者控制的网络)或渗透受害者的家庭网络，感染他/她的电脑。
- 减少功能:在这种情况下，攻击者试图关闭或限制设备的功能，以激怒受害者或在更广泛的系统中制造故障。例如，这种类型的攻击可能直接指向物联网设备，来勒索受害者的钱。
- 滥用功能:物联网设备的正常功能被用来给其所有者制造不适。例如，攻击者可能会篡改暖通空调(HV AC)控制单元，通过过度提高或降低温度，使某些环境不舒服。
- 扩展功能:物联网设备用于实现完全不同的功能。例如，警报系统的存在传感器可以用来跟踪受害者在其生活环境中的位置。

## III. MAIN SECURITY MECHANISMS FOR IOT SERVICES

在本节中，我们将介绍为满足前一节中描述的需求而设计的标准安全机制。

### 加密

在通信过程中确保机密性是最主要也是最重要的操作。

- 使用哈希函数将实际消息(明文)更改为不同的消息(密文)

- 对称加密
- 非对称加密

### 标准加密机制

加密过程可以通过两种不同的方式来执行:通过流密码，逐位(或逐字节)加密明文，或者使用块密码，将一个明文块作为一个整体处理，并生成一个长度相等的密文块

- 分组密码：要对长信息进行编码，分组密码可以在不同的操作模式下使用:电子码本(ECB);密码块链(CBC);密码反馈(CFB);输出反馈(OFB);及计算器模式(CTR)。

- 用于对称加密的最常用的分组密码之一是由国家标准和技术研究所(NIST)[27]于2001年发布的高级加密标准(AES),AES是通过三个基本分组密码的连续序列级联得到的:替换密码、置换密码和线性密码。根据图2。AES块密码的加密。替换(S)、置换(T)和线性(L)三种密码块被重复以获得最终的加密。

![](./img/QQ截图20211123191217.png)

- 非对称密码系统的例子是Rivest Shamir Adleman (RSA) ， McEliece和Elgamal算法。
- 加密也可以用于提供身份验证和完整性保护,在物联网系统中认证和完整性保护是通过消息认证码(对称机制)、数字签名(非对称机制)和哈希函数来提供的。
- 对于与消息身份验证码和数字签名有关的内容，所传输的消息是明文和使用私钥从明文计算出的标记的拼接结果。在接收端，使用私钥或公钥计算标记(取决于我们选择的是对称处理还是非对称处理)，并将其与传输的标记进行比较。这个操作需要时间并且消耗设备电池的能量。
- 如果机密性不是问题，更好的解决方案可能是以明文发送消息，并附加标识发送者的标记。然后，可以由一个指定的受信任的接收方（第三方）执行消息真实性的验证，而所有其他节点可以只读取消息，而不会浪费时间和资源。标签通常通过使用良好的加密函数(如AES)来获得。

### 轻量级加密

- 轻量级密码学是密码学的一个新分支，它关注于这些方面，包括新的加密块和流密码、消息验证码和哈希函数，这些被认为是由计算、通信和存储能力有限的设备执行的。它运算速度快，适用于大数据。

- 2019年初，NIST发布了轻量级密码算法的呼吁:经过讨论和评估，这些算法将通过一个标准化流程。

### 随机数生成器

安全性的一个重要方面是随机性:安全协议经常需要为不同的目的生成(伪)随机数，例如，在身份验证阶段创建随机数，避免重放攻击，以及生成非对称密钥。

### 安全硬件

物联网设备容易受到边缘层攻击。大多数设备可以部署在保护水平较低的场景下，非法用户可以进行侧通道攻击。

- 以利用硬件和软件解决方案来消除或至少随机化这种类型的攻击所利用的信号足迹。例如，可以采用物理不可克隆函数puf (physical unclonable  functions)来提高硬件安全性。PUF的基本概念是利用芯片制造过程中产生的微小差异来产生每个器件的独特特征。PUF电路对给定的输入挑战提供响应，由于固有的硬件差异，响应是特定于芯片的。例如，一个仲裁PUF电路由两条假设相同的路径组成:对于每个输入，输出取决于最快的路径
- Majzoobiet al.[49]提出了轻量级安全PUF的概念，其中响应生成能够抵抗试图通过参数化建模PUF行为来模拟PUF的反向工程攻击。
- 基于RSA签名中参数的随机化，在A side-channel attack counter-measure based on segmented modular exponent randomizing in RSA cryptosystem [53]中报告了一个软件对策。

### 入侵检测系统

除了防止攻击之外，能够检测正在进行的攻击也是很重要的。

- 由于资源和能源的限制，复杂的杀毒软件和流量分析仪无法用于物联网设备。为此，轻量级的入侵检测方法在过去几年已经提出了[54]。

- 例如，系统参数中的异常，如CPU使用率、内存消耗和网络吞吐量，可能表明正在进行的攻击[55]。

- [56]中提出了一个类似的方法:能量剖面被分析来检测电力消耗的异常，这与不同类型的攻击相联系。
- 在[57]中，各种攻击的特征来自于相关的特征，如包丢弃/发送速率和信号强度强度。将流量模式与这些签名进行比较，可以很好地检测到攻击。机器学习也可以用于入侵检测。

- 在[58]中，一个随机森林分类算法被用来根据一些选定的特征将流量分组到不同的类别中。当一些流表现为非标准模式时，就会检测到攻击，因此将其归类为异常模式。

## 四、常用通信技术的安全性

标准Internet中使用的大多数遗留安全协议不能简单地应用于物联网场景，因为许多物联网设备在计算能力、能力和通信能力[59]方面受到限制。因此，文献中已经提出了专门为物联网场景设计的新机制，并在一些商用物联网系统中实现。在本节中，关注物联网领域中使用的一些最流行的传输技术实现的安全机制，即ZigBee、BLE、6LoWPAN和LoRaWAN。

ZigBee、BLE和6LoWPAN主要用于家庭或小型办公室的短程通信。LoRaWAN被用于远程场景，如城市范围的监控应用。

### A. ZigBee 紫峰

#### Description

ZZigBee，也称紫蜂，是一种低速短距离传输的无线网上协议，底层是采用IEEE 802.15.4标准规范的媒体访问层与物理层。主要特色有低速、低耗电、低成本、支持大量网上节点、支持多种网上拓扑、低复杂度、快速、可靠、安全。

![](./img/QQ截图20211123204646.png)

每个ZigBee网络都包括一个信任中心，即一个受网络中所有其他节点信任的设备。信任中心通常对应于网络协调器，负责

- 对需要加入网络的设备进行身份验证;

- 决定是否接受或拒绝加入请求;

- 维护和分发网络密钥;

- 实现设备之间的端到端安全。

  ZigBee网络可以是星型拓扑(终端设备直接连接到协调器)，也可以是树型拓扑(中间路由器进行互连)。通过连接路由器，可以实现网状拓扑结构，如图所示。

![](./img/QQ截图20211123210248.png)

设备可以通过不同的方式获取所需的链路或网络密钥

- 预安装:在制造过程中，将链路或网络密钥安装在设备上。
- 密钥传输:在其他地方(通常由信任中心)生成链路或网络密钥，然后传输给设备。该标准建议使用带外技术加载密钥，然而，它包括在带内发送密钥的可能性。在后一种情况下，密钥可以明文发送，或者使用特定于每个应用程序概要文件的预共享密钥进行加密。例如，对于家庭自动化设备，预共享密钥在ZigBee标准中定义，并且是公开可用的。相反，根据ZLL规范[63]，对于ZigBee轻链接(ZLL)设备，预共享密钥将只分发给经过认证的制造商，并受安全保管合同约束。然而，2015年它被泄露在互联网上，所以现在它是众所周知的[62]，[64]。
- 密钥建立:通过此过程，信任中心与网络中的另一个设备共享一条keyLi链路，以确保信任中心与网络中的另一个设备之间的通信安全。这个过程从交换在制造过程中预先安装的可信信息——主密钥开始。主密钥由ZigBee联盟提供给其成员，每个应用程序配置文件都不同。在此阶段之后，设备和信任中心交换用于派生veli的临时数据。当两台设备需要相互通信时，信任中心为它们提供一个链接key Li和Lj，分别使用链接key Li和Lj进行加密。注意，此方法不能用于生成网络密钥。

建立一个新的ZigBee网络或将一个新的ZigBee设备添加到现有网络的过程称为调试。除了不同应用程序配置文件的特定调试程序外，ZigBee标准还指定了一个通用程序，使不同配置文件的设备互连成为可能.

#### 攻击

ZigBee网络中一个可能的攻击在于发现用于保护通信的密钥。

- 例如，已知和固定消息(如标准中定义的控制消息)的重复加密使得系统容易受到明文攻击[62]。
  - T. Zillner, “ZigBee smart homes: A hacker’s open house,”inProc. CRESTCon Conf., May 2016. [Online]. Available:https://www.youtube.com/watch?v=eK-kI7Q9DE4

- 针对ZigBee网络的天坑攻击在[65]中提出,该攻击是通过合法加入网络的恶意实体执行的，但随后假装拥有下图，一种智能照明系统的总体架构。

![](./img/QQ截图20211124153938.png)

​		为了吸引更多的传输流，向协调器提供有效的路由路径。这样，攻击者就可以修改或丢弃进入的报文。此外，如果恶意实体直接连接		到互联网，所有ZigBee网络都将受到互联网攻击。

- 在[66]中提出的幽灵攻击不需要了解通信密钥。其目的是消耗ZigBee节点的能量，增加其他DoS攻击的成功概率。

- 最后，KillerBee是一种实用的攻击ZigBee设备的工具[67]。该框架使得在ZigBee网络中嗅探和注入流量以及解码和操纵数据包成为可能。在[68]中，介绍了一些利用该工具的攻击，如重放攻击。其他攻击载体是特定于ZLL安装的。

- Morgneret等[64]研究了三种不同的ZigBee智能灯具系统的安全级别，即osram Lightify、GE Link和philips Hue。该研究评估了灯泡和互连设备的脆弱性，并报告七种不同类型的攻击。这种攻击是基于跨网帧的攻击，跨网帧用于传输touchlink调试命令。这些帧既不安全也不经过身份验证:恶意实体可以假装属于网络发送相同的命令。然后，攻击者可以进行非法操作，危及网络的安全，下面将详细说明。
  - 活跃设备扫描 Active Device Scan
  - 眨眼攻击 Blink Attack
  - 重置攻击 Reset Attack
  - DoS Attack 
  - Hijack Attack 劫持攻击
  - 网络密钥提取攻击 Network Key Extraction Attack
  - 命令注入攻击 Inject Commands Attack

### B. Bluetooth Low Energy 蓝牙低功耗

#### 介绍

蓝牙是一种广泛使用的短距离无线通信协议。其低能耗、物联网定制版BLE在蓝牙核心规范4.0版本中首次被引入[69]。

- 组成：主从设备，在通信设置期间，主服务器充当启动器，从服务器与它们相关联[70]。这些实体以星型拓扑连接，其中每个从机都与一个主机相关联，如图所示。

  ![](./img/QQ截图20211124160145.png)

##### 初始版本

- BLE加密和认证过程基于AES-CCM，使用128位密钥,主从链路的对称密钥是在配对过程中生成的，配对过程如下所示。

  - 设备之间交换认证能力和需求。这个阶段是完全不加密的。
  - 设备使用一种可用的配对方法生成或交换临时密钥(TK)。然后他们交换一些值，以确认TK对于两个设备是相同的。之后，从TK生成一个短期密钥(STK)。STK将用于加密数据流。

  最后，绑定阶段可以选择性地遵循配对过程:在这个过程中，设备交换和存储公共链接键(即键)，这些键可以在以后两个设备之间的链路重新建立时重用。

- 可用的配对方法有以下三种:
  - Just  Works:  TK设置为0。当然，这不能提供任何级别的安全性。
  - Out of Band:TK交换，例如，使用近场通信。此方法提供了与用于交换密钥的带外方法一样高的安全级别。然而，它可能对用户不方便。
  - Passkey:  TK是一个六位数的数字，用户在设备之间传递。例如，其中一个设备生成数字并将其显示在显示器上:然后用户必须向另一个设备输入相同的数字。在这种情况下，安全级别很高，但设备需要配备用户界面，以便能够读取和输入TK，这对于小型物联网设备可能是不切实际的。

##### 4.2版本

- 从BLE版本4.2开始，一个新的配对过程已经就位，使用椭圆曲线密码术。

  - 每个设备生成一个椭圆曲线的Diffie Hellman  (ECDH)公私钥对。然后，他们彼此交换公钥，利用椭圆曲线函数，从自己的密钥和另一个设备的公钥得到一个密钥，名为dhkey。
  - 设备使用一种可用的配对方法来确认两者的dhkeyis相同，并生成一个长期密钥(LTK)，该密钥将用于对称加密数据流。
  - 可选的是，设备可以执行最后一步，就像BLE  4.1版本那样。

- 配对方法也得到了更新，在以前的版本中引入了新的选项并加固了方法

  - Just  Works:非初始化设备生成一个nonce和一个确认值ecb，两个设备的nonce和公钥的函数。然后将该nonce发送到初始化设备。后者生成自己的nonce并将其发送给非初始化设备。它还使用非初始化设备nonce和公钥来检查接收到的codeCbis是否有效。显然，这并不能提供任何安全性，因为攻击者可以生成自己的nonce并使用公钥创建有效的确认值。
  - 数值比较:这种方法很有效，但设备也生成一个值，该值是公钥和nonce的函数。该值必须显示给用户，用户必须手动确认显示的数字在两台设备中是相同的。最后一步用前面的方法解决了这个问题。
  - Out of Band:该方法以带外方式交换随机数和承诺值，这些随机数和公钥的函数，如使用近场通信。使用这种方法，所获得的安全级别等于所选择的带外方法的完整性和保密性。
  - Passkey:在这种方法中，用户首先向两个设备输入一个比特长的秘密密钥(或者从一个设备读取并输入到另一个设备)。然后，对于每个biti=1，…，则设备必须执行两个步骤:
    - a)每台设备生成一个nonce并计算一个承诺值，该承诺值是nonce、密钥和公钥的函数。然后在设备之间交换承诺和nonces。
    - B)之后，每台设备像以前一样重新计算承诺，但交换两个公钥的顺序，并使用另一台设备的nonce。如果密钥相同，则承诺值必须等于之前找到的承诺值。

  然而，使用椭圆曲线密码也并非没有缺点:根据[72]的实验结果，执行一次ECDHECDSA密钥交换所消耗的能量是对称加密技术(236  mJ和38µJ)的6000多倍。

#### 攻击

- 在BLE 4.0和4.1中，除了带外配对外，在配对阶段没有对窃听和中间人攻击的保护。实际上，在Just  Works配对方法中，密钥是已知的，而在Passkey方法中，密钥很容易被蛮力强制使用。在某些情况下，甚至不需要使用蛮力[73]-[77]。BLE  4.2也受到类似问题的影响，主要是针对Passkey配对[77]，[78]。

- 另一个问题与BLE设备的advertise mode广播模式有关。Daset  al.[71]发现，所分析的健身追踪器几乎总是处于advertise mode。这是因为为了保存能量，主设备经常断开与跟踪器的连接。因此，当健康追踪器的智能手机应用程序没有运行时，追踪器关闭其通信链路，保持advertise mode，直到下一次连接建立。而且，在[71]中分析的大多数设备总是暴露相同的MAC地址。这使得捕获交换的消息并在很长一段时间内关联一对设备之间的BLE流量成为可能。

- Ariaset等[80]描述了另一种可以对可穿戴健身设备进行的攻击。这是基于固件攻击，只有当攻击者物理访问设备时才能实现。
- 此外，[79]中的分析表明，在大多数情况下，健康跟踪应用程序通过Internet传输每个记录的事件，这允许攻击者对交换的数据量进行数据分析。
- 在2016年DEF  CON大会上，研究人员提出了大量使用BLE与用户智能手机通信的门锁和挂锁设备的几个安全漏洞[82]，[83]。他们发现，“快锁”、“快锁挂锁”和“布洛克挂锁”等设备的密码以明文传输，因此很容易被窃听。其他设备使用由少量字符组成的密码，使暴力破解变得可行。

### C.6LoWPAN and CoAP

#### 介绍

6LoWPAN和CoAP是两个IETF协议，可以在物联网设备中实现，以简化它们与基于ip的标准系统的交互。

![](./img/QQ截图20211124164335.png)

- 6LowPAN是一种IPv6适配协议，用于资源受限的设备在低功耗和有损耗的链路.

  CoAP是位于应用层的RESTful协议，它位于UDP传输协议之上。它被设计成可以通过代理轻松映射到HTTP，以支持重传、休眠设备和资源发现。

- 在PHY和MAC层，使用6LowPAN和CoAP的网络通常依赖IEEE  802.15.4系列协议。相反，物联网网络中的路由通常基于低功耗和有损网络(RPL)的IPv6路由协议，定义在RFC 6550[90]。

#### 攻击

- 假设的攻击者可以针对RPL或在自适应层操作，基于它希望实现的对网络的控制级别。

  - 针对RPL的攻击:针对6LoWPAN的许多攻击集中在重定向流量和扰乱路由树。下面我们将报告一些此类攻击的例子[91]-[93]。
    - 克隆ID和Sibyl攻击 Clone ID and Sibyl Attacks
    - 天坑攻击 Sinkhole Attack
    - 选择性发送和黑洞攻击 Selective Forwarding and Black Hole Attacks
    - Hello Flooding Attack 洪水攻击

  - 依赖于利用RPL服务消息的攻击[91]-[93]
    - 本地修复攻击 Local Repair Attack
    - 版本号攻击 Version Number Attack

- 互联网端的攻击:6LoWPAN和CoAP都不提供保密、身份验证或完整性保护。因此，在没有额外安全措施的情况下使用6LoWPAN和CoAP，可以从Internet上完全访问这些设备。已经有人提议扩展CoAP以提供内置安全性，但它尚未被纳入标准[94]。

- 适配层攻击:公网和6LoWPAN网络之间的报文转发在边界路由器上进行。由于缺乏认证和执行适配的设备计算资源有限，该机制容易受到攻击。

- 为了保护6LoWPAN网络免受攻击，专门针对物联网网络的入侵检测系统已经被研究[91]-[93]。入侵检测系统监控网络参数，可以识别入侵或攻击的迹象。对6LoWPAN网络的入侵检测系统进行了优化，最大限度地节省网络资源。由于攻击面巨大，入侵检测系统应该同时在适配层、RPL层和应用层进行操作。因此，需要采用一种混合架构，即在边界路由器上安装一个集中式模块，与内部节点上安装的分布式模块相配合。

### D. LoRaWAN

#### 介绍

LoRaWAN是由LoRa联盟在2015年推出的[100]，是位于LoRa物理层之上的链路层协议。协议栈如图所示。

![](./img/QQ截图20211124173844.png)

LoRaW AN针对电池供电的终端设备进行了优化。LoRaW AN具有星形拓扑结构，包括终端设备、网关和网络服务器，如图所示。

![](./img/QQ截图20211124174020.png)

#### 攻击

- LoRaWAN协议的第一个缺点是与tokey管理相关[103]。AppKey、NwkSKey和AppSKey都存储在终端设备中。因此，利用旁路信道分析攻击可以利用加密过程中收发机功耗或电磁发射的变化来恢复密钥。

- 攻击者还可能关注网关和网络服务器之间的链路。即使在原则上，任何遗留IP协议都可以用于这样的连接，但在实践中，许多部署都依赖Semtech提供的协议，该协议基于普通的无保护UDP。因此，虽然LoRaWAN包的有效载荷是加密的，但仍然有可能通过伪造或修改网络管理包中断网络服务。
- 由于信标和组播消息，B类网络引入了其他的威胁[103]。即信标消息没有加密:它们代表了网络信息的来源，并提供了一种将恶意数据注入其中的方法。实际上，信标也可以由攻击者生成，而且由于节点无法区分恶意信标消息和真实信标消息，网络操作很容易受到干扰。

## 五、 在商业设备中的实例
- A.ZigBee Implementations

- B. BLE Implementations

- C. Devices With 6LoWPAN Stack

- D. LoRa Devices

## 六、结束语

鉴于物联网解决方案广泛应用于传感器网络、家政和健康应用，在物联网网络中提供安全通信至关重要。在这种情况下，终端用户往往不知道与设备相关的安全问题，这是她/他的日常生活的一部分。例如，如果没有防止窃听的保护措施，物联网无线网络可能会暴露敏感的个人信息。此外，在没有身份验证的情况下，恶意攻击者可以伪装成合法设备，扰乱物联网网络运营。除了协议和网络安全设计相关的问题外，计算能力的降低和对低能耗的需求限制了可以安装在物联网设备上的加密功能。

文献中已经提出了对现有标准的其他安全扩展，但它们还没有被标准化实体和商业设备采用。例如，[72]proposesCryptoCoP是一种用于资源受限设备的加密协议，它支持BLE的高效对称密钥加密。Bonettoet  al.[119]提出了另一个有趣的解决方案，将设备的计算密集型任务分散到一个可信且不受约束的网络节点;然后，该节点负责代表一组受约束的物联网设备计算主会话密钥。Zhou和Piramuthu[120]调查了物联网设备，特别是Fitbitfitness追踪器文献中安全改进建议的一些问题。在[121]中，提出了一种基于时间戳的物联网连接建立和密钥交换算法。基于时间的安全密钥生成方法旨在有效地管理和更新密钥以提供可信连接，同时保证在不安全通道上传输的数据的完整性。时间戳和nces也用于避免攻击基于6LoWPAN中的数据包。

## 七、一些开放的研究方向

尽管安全专家提出了许多机制，但物联网网络安全领域仍然存在许多开放的研究挑战。

ZigBee和6LoWPAN都受到了网络通信协议的攻击，因为报文中的路由信息通常没有经过身份验证。类似地，它们受到能量或资源耗尽攻击，迫使节点处理大量伪造的数据包。完整报头和控制包认证将阻止许多此类攻击，并提高网络的功能级特性。然而，有两个因素阻碍了这种全面的认证程序的部署。第一个原因与缺乏一种被广泛接受的轻量级加密算法有关，这种算法可以在硬件中实现，或者由用于嵌入式设备的最常见的加密库支持。第二种方法与为了这个额外的身份验证需求而添加到包中的补充信息有关，这将增加短有效负载消息已经产生的巨大开销。因此，需要使用数据包中少量额外空间的强身份验证机制，或使用从物理层获取的替代信息类型的机制。物理层身份验证是一种可能的解决方案，但它的成熟度还不足以在商业产品中实现。

第二个开放的挑战是关于共享密钥的管理，这是不同协议的一个共同弱点(见表4)。正如协议分析中提到的，调试和配置过程往往需要网络中所有节点之间共享密钥。然而，这样一个密钥的管理是一项复杂的任务，因为密钥更新需要它在整个网络中安全、及时地分发。此外，还需要额外的开销来保证设备间共享密钥的一致性。由于共享密钥更有可能被攻击者发现，因此密钥轮换应该会非常频繁地发生，从而进一步加剧问题。为了避免共享密钥管理的复杂性，需要一种机制来允许设备独立地创建和更新共享密钥，例如使用所有设备可用但攻击者未知的信息。正如我们所看到的，给定技术的物理实现与理论设计同样重要。例如，使用质量差的熵源微控制器可能允许攻击者提取密码程序中使用的密钥。
